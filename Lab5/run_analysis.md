run\_analysis.R
================
v.yeshchenkov
2020-04-28

``` r
library(reshape2)

archiveName <- "data.zip"
url <- "https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip"


## Завантаження та зчитування даних
# Завантаження
if(!file.exists(archiveName)){
  download.file(url,archiveName, mode = "wb") 
}

# Розархівування
if(!file.exists("UCI HAR Dataset")){
  unzip(archiveName, files = NULL, exdir=".")
}


# train data
x_train <- read.table("UCI HAR Dataset/train/X_train.txt")
y_train <- read.table("UCI HAR Dataset/train/Y_train.txt")
s_train <- read.table("UCI HAR Dataset/train/subject_train.txt")

# test data
x_test <- read.table("UCI HAR Dataset/test/X_test.txt")
y_test <- read.table("UCI HAR Dataset/test/Y_test.txt")
s_test <- read.table("UCI HAR Dataset/test/subject_test.txt")

feature <- read.table("UCI HAR Dataset/features.txt")
a_label <- read.table("UCI HAR Dataset/activity_labels.txt")

# 1. Об’єднує навчальний та тестовий набори, щоб створити один набір даних.
x_data <- rbind(x_train, x_test)
y_data <- rbind(y_train, y_test)
s_data <- rbind(s_train, s_test)

head(x_data)
```

    ##          V1          V2         V3         V4         V5         V6
    ## 1 0.2885845 -0.02029417 -0.1329051 -0.9952786 -0.9831106 -0.9135264
    ##           V7         V8        V9        V10        V11        V12
    ## 1 -0.9951121 -0.9831846 -0.923527 -0.9347238 -0.5673781 -0.7444125
    ##         V13       V14       V15        V16        V17       V18        V19
    ## 1 0.8529474 0.6858446 0.8142628 -0.9655228 -0.9999446 -0.999863 -0.9946122
    ##          V20        V21      V22        V23        V24        V25
    ## 1 -0.9942308 -0.9876139 -0.94322 -0.4077471 -0.6793375 -0.6021219
    ##         V26        V27       V28         V29       V30        V31
    ## 1 0.9292935 -0.8530111 0.3599098 -0.05852638 0.2568915 -0.2248476
    ##         V32         V33       V34        V35      V36        V37       V38
    ## 1 0.2641057 -0.09524563 0.2788514 -0.4650846 0.491936 -0.1908836 0.3763139
    ##         V39       V40       V41        V42       V43        V44        V45
    ## 1 0.4351292 0.6607903 0.9633961 -0.1408397 0.1153749 -0.9852497 -0.9817084
    ##         V46        V47        V48        V49       V50        V51
    ## 1 -0.877625 -0.9850014 -0.9844162 -0.8946774 0.8920545 -0.1612655
    ##         V52       V53        V54        V55       V56       V57        V58
    ## 1 0.1246598 0.9774363 -0.1232134 0.05648273 -0.375426 0.8994686 -0.9709052
    ##          V59        V60        V61        V62 V63 V64       V65       V66
    ## 1 -0.9755104 -0.9843254 -0.9888491 -0.9177426  -1  -1 0.1138061 -0.590425
    ##         V67        V68       V69        V70       V71        V72    V73
    ## 1 0.5911463 -0.5917735 0.5924693 -0.7454488 0.7208617 -0.7123724 0.7113
    ##          V74       V75        V76       V77       V78       V79       V80
    ## 1 -0.9951116 0.9956749 -0.9956676 0.9916527 0.5702216 0.4390273 0.9869131
    ##          V81         V82         V83        V84      V85       V86
    ## 1 0.07799634 0.005000803 -0.06783081 -0.9935191 -0.98836 -0.993575
    ##          V87        V88        V89        V90        V91        V92
    ## 1 -0.9944876 -0.9862066 -0.9928183 -0.9851801 -0.9919942 -0.9931189
    ##         V93       V94       V95       V96        V97        V98        V99
    ## 1 0.9898347 0.9919569 0.9905192 -0.993522 -0.9999349 -0.9998204 -0.9998785
    ##        V100       V101       V102       V103       V104       V105 V106
    ## 1 -0.994364 -0.9860249 -0.9892336 -0.8199492 -0.7930464 -0.8888529    1
    ##        V107      V108      V109      V110        V111      V112      V113
    ## 1 -0.220747 0.6368308 0.3876436 0.2414015 -0.05225285 0.2641772 0.3734395
    ##        V114       V115      V116       V117       V118       V119
    ## 1 0.3417775 -0.5697912 0.2653988 -0.4778749 -0.3853005 0.03364394
    ##         V120         V121        V122      V123       V124       V125
    ## 1 -0.1265108 -0.006100849 -0.03136479 0.1077254 -0.9853103 -0.9766234
    ##         V126       V127       V128       V129       V130      V131
    ## 1 -0.9922053 -0.9845863 -0.9763526 -0.9923616 -0.8670437 -0.933786
    ##         V132     V133      V134      V135       V136       V137       V138
    ## 1 -0.7475662 0.847308 0.9148953 0.8308405 -0.9671843 -0.9995783 -0.9993543
    ##         V139       V140      V141       V142       V143      V144
    ## 1 -0.9997634 -0.9834381 -0.978614 -0.9929656 0.08263168 0.2022676
    ##         V145       V146       V147      V148       V149 V150       V151
    ## 1 -0.1687567 0.09632324 -0.2749851 0.4986442 -0.2203169    1 -0.9729714
    ##        V152      V153      V154      V155      V156      V157      V158
    ## 1 0.3166545 0.3757264 0.7233992 -0.771112 0.6902132 -0.331831 0.7095838
    ##        V159      V160       V161        V162       V163       V164
    ## 1 0.1348734 0.3010995 -0.0991674 -0.05551737 -0.0619858 -0.9921107
    ##         V165       V166       V167       V168      V169       V170
    ## 1 -0.9925193 -0.9920553 -0.9921648 -0.9949416 -0.992619 -0.9901558
    ##         V171       V172      V173      V174      V175       V176
    ## 1 -0.9867428 -0.9920416 0.9944288 0.9917558 0.9893519 -0.9944534
    ##         V177       V178       V179       V180       V181      V182
    ## 1 -0.9999375 -0.9999535 -0.9999229 -0.9922997 -0.9969389 -0.992243
    ##        V183      V184       V185      V186      V187      V188        V189
    ## 1 -0.589851 -0.688459 -0.5721069 0.2923763 -0.361998 0.4055427 -0.03900695
    ##        V190       V191      V192      V193      V194     V195      V196
    ## 1 0.9892838 -0.4145605 0.3916025 0.2822509 0.9272698 -0.57237 0.6916192
    ##        V197      V198        V199      V200       V201       V202
    ## 1 0.4682898 -0.131077 -0.08715969 0.3362475 -0.9594339 -0.9505515
    ##         V203       V204       V205       V206       V207       V208
    ## 1 -0.9579929 -0.9463052 -0.9925557 -0.9594339 -0.9984928 -0.9576374
    ##         V209       V210        V211       V212      V213       V214
    ## 1 -0.2325816 -0.1731787 -0.02289666 0.09483157 0.1918171 -0.9594339
    ##         V215       V216       V217       V218       V219       V220
    ## 1 -0.9505515 -0.9579929 -0.9463052 -0.9925557 -0.9594339 -0.9984928
    ##         V221       V222       V223        V224       V225      V226
    ## 1 -0.9576374 -0.2325816 -0.1731787 -0.02289666 0.09483157 0.1918171
    ##         V227       V228       V229      V230       V231       V232
    ## 1 -0.9933059 -0.9943364 -0.9945004 -0.992784 -0.9912085 -0.9933059
    ##         V233       V234       V235      V236       V237       V238
    ## 1 -0.9998919 -0.9929337 -0.8634148 0.2830852 -0.2373087 -0.1054322
    ##          V239       V240       V241       V242       V243       V244
    ## 1 -0.03821231 -0.9689591 -0.9643352 -0.9572448 -0.9750599 -0.9915537
    ##         V245       V246       V247       V248      V249       V250
    ## 1 -0.9689591 -0.9992865 -0.9497658 0.07257904 0.5725114 -0.7386022
    ##        V251     V252       V253       V254      V255       V256      V257
    ## 1 0.2125778 0.433405 -0.9942478 -0.9913676 -0.993143 -0.9889356 -0.993486
    ##         V258      V259       V260       V261      V262       V263
    ## 1 -0.9942478 -0.999949 -0.9945472 -0.6197676 0.2928405 -0.1768892
    ##         V264       V265       V266       V267       V268       V269
    ## 1 -0.1457792 -0.1240723 -0.9947832 -0.9829841 -0.9392687 -0.9954217
    ##        V270      V271       V272       V273      V274       V275
    ## 1 -0.983133 -0.906165 -0.9968886 -0.9845193 -0.932082 -0.9937563
    ##         V276       V277       V278       V279       V280       V281
    ## 1 -0.9831629 -0.8850542 -0.9939619 -0.9934461 -0.9234277 -0.9747327
    ##         V282       V283       V284      V285       V286       V287
    ## 1 -0.9999684 -0.9996891 -0.9948915 -0.995926 -0.9897089 -0.9879912
    ##         V288       V289       V290 V291 V292 V293      V294      V295
    ## 1 -0.9463569 -0.9047478 -0.5913025   -1   -1   -1 0.2524829 0.1318358
    ##          V296      V297       V298       V299       V300      V301
    ## 1 -0.05205025 0.1420506 -0.1506825 -0.2205469 -0.5587385 0.2467687
    ##           V302       V303       V304       V305       V306       V307
    ## 1 -0.007415521 -0.9999628 -0.9999865 -0.9999791 -0.9999624 -0.9999322
    ##         V308       V309       V310       V311       V312       V313
    ## 1 -0.9997251 -0.9996704 -0.9999858 -0.9999687 -0.9999769 -0.9998697
    ##         V314       V315       V316       V317       V318      V319
    ## 1 -0.9997761 -0.9999712 -0.9999193 -0.9996568 -0.9998605 -0.999867
    ##        V320       V321       V322       V323       V324       V325
    ## 1 -0.999863 -0.9997378 -0.9997322 -0.9994926 -0.9998136 -0.9996818
    ##         V326       V327      V328       V329       V330       V331
    ## 1 -0.9998394 -0.9997382 -0.999612 -0.9996872 -0.9998386 -0.9935923
    ##         V332      V333       V334       V335       V336       V337
    ## 1 -0.9994758 -0.999662 -0.9996423 -0.9992934 -0.9978922 -0.9959325
    ##         V338       V339       V340       V341       V342       V343
    ## 1 -0.9951464 -0.9947399 -0.9996883 -0.9989246 -0.9956713 -0.9948773
    ##         V344       V345       V346       V347       V348       V349
    ## 1 -0.9994544 -0.9923325 -0.9871699 -0.9896961 -0.9958207 -0.9909363
    ##         V350       V351       V352       V353       V354       V355
    ## 1 -0.9970517 -0.9938055 -0.9905187 -0.9969928 -0.9967369 -0.9919752
    ##         V356       V357       V358       V359      V360       V361
    ## 1 -0.9932417 -0.9983491 -0.9911084 -0.9598854 -0.990515 -0.9999347
    ##         V362       V363       V364       V365       V366 V367 V368 V369
    ## 1 -0.9998205 -0.9998845 -0.9930263 -0.9913734 -0.9962396   -1   -1   -1
    ##   V370  V371 V372      V373     V374      V375       V376       V377
    ## 1    1 -0.24   -1 0.8703845 0.210697 0.2637079 -0.7036858 -0.9037425
    ##         V378       V379       V380       V381       V382       V383
    ## 1 -0.5825736 -0.9363101 -0.5073447 -0.8055359 -0.9999865 -0.9999796
    ##         V384       V385       V386       V387       V388       V389
    ## 1 -0.9999748 -0.9999551 -0.9999186 -0.9996401 -0.9994833 -0.9999609
    ##         V390       V391      V392       V393       V394       V395
    ## 1 -0.9999823 -0.9999707 -0.999811 -0.9994847 -0.9999808 -0.9998519
    ##         V396       V397       V398       V399       V400       V401
    ## 1 -0.9999326 -0.9998999 -0.9998244 -0.9998598 -0.9997275 -0.9997288
    ##         V402       V403       V404       V405       V406       V407
    ## 1 -0.9995671 -0.9997652 -0.9999002 -0.9998149 -0.9997098 -0.9995961
    ##         V408       V409       V410       V411       V412       V413
    ## 1 -0.9998522 -0.9998221 -0.9993999 -0.9997656 -0.9999585 -0.9999495
    ##         V414       V415       V416       V417       V418       V419
    ## 1 -0.9998385 -0.9998135 -0.9987805 -0.9985778 -0.9996197 -0.9999836
    ##         V420       V421       V422       V423       V424       V425
    ## 1 -0.9998281 -0.9986807 -0.9998442 -0.9999279 -0.9865744 -0.9817615
    ##         V426       V427       V428       V429       V430       V431
    ## 1 -0.9895148 -0.9850326 -0.9738861 -0.9940349 -0.9865308 -0.9836164
    ##        V432       V433       V434       V435       V436       V437
    ## 1 -0.992352 -0.9804984 -0.9722709 -0.9949443 -0.9975686 -0.9840851
    ##         V438       V439       V440       V441       V442       V443
    ## 1 -0.9943354 -0.9852762 -0.9998637 -0.9996661 -0.9999346 -0.9903439
    ##         V444       V445       V446       V447      V448 V449 V450 V451
    ## 1 -0.9948357 -0.9944116 -0.7124023 -0.6448424 -0.838993   -1   -1   -1
    ##         V452       V453     V454      V455      V456     V457        V458
    ## 1 -0.2575489 0.09794711 0.547151 0.3773112 0.1340915 0.273372 -0.09126183
    ##         V459       V460      V461       V462       V463       V464
    ## 1 -0.4843465 -0.7828507 -0.999865 -0.9999318 -0.9999729 -0.9999702
    ##         V465       V466      V467       V468       V469       V470
    ## 1 -0.9999301 -0.9999586 -0.999929 -0.9999847 -0.9998633 -0.9999681
    ##         V471       V472       V473      V474       V475       V476
    ## 1 -0.9999361 -0.9999536 -0.9998644 -0.999961 -0.9994537 -0.9999781
    ##         V477       V478       V479       V480      V481       V482
    ## 1 -0.9999915 -0.9999901 -0.9999686 -0.9998066 -0.998346 -0.9989612
    ##         V483       V484       V485       V486       V487       V488
    ## 1 -0.9996187 -0.9999893 -0.9999354 -0.9983875 -0.9996426 -0.9999727
    ##         V489       V490       V491       V492       V493       V494
    ## 1 -0.9999554 -0.9999763 -0.9999058 -0.9999855 -0.9999372 -0.9997512
    ##         V495       V496       V497       V498       V499       V500
    ## 1 -0.9990723 -0.9999275 -0.9999516 -0.9999058 -0.9998927 -0.9994443
    ##        V501       V502       V503      V504       V505       V506
    ## 1 -0.999941 -0.9999586 -0.9521547 -0.956134 -0.9488701 -0.9743206
    ##         V507       V508       V509       V510       V511       V512
    ## 1 -0.9257218 -0.9521547 -0.9982852 -0.9732732 -0.6463764 -0.7931035
    ##          V513      V514       V515       V516      V517       V518
    ## 1 -0.08843612 -0.436471 -0.7968405 -0.9937257 -0.993755 -0.9919757
    ##         V519       V520       V521       V522       V523 V524       V525
    ## 1 -0.9933647 -0.9881754 -0.9937257 -0.9999184 -0.9913637   -1 -0.9365079
    ##        V526       V527     V528       V529       V530       V531
    ## 1 0.3469885 -0.5160801 -0.80276 -0.9801349 -0.9613094 -0.9736534
    ##         V532       V533       V534       V535       V536       V537 V538
    ## 1 -0.9522638 -0.9894981 -0.9801349 -0.9992403 -0.9926555 -0.7012914   -1
    ##         V539      V540      V541       V542       V543       V544
    ## 1 -0.1289889 0.5861564 0.3746046 -0.9919904 -0.9906975 -0.9899408
    ##         V545       V546       V547       V548       V549       V550 V551
    ## 1 -0.9924478 -0.9910477 -0.9919904 -0.9999368 -0.9904579 -0.8713058   -1
    ##          V552       V553       V554       V555       V556       V557
    ## 1 -0.07432303 -0.2986764 -0.7103041 -0.1127543 0.03040037 -0.4647614
    ##          V558       V559      V560        V561
    ## 1 -0.01844588 -0.8412468 0.1799406 -0.05862692
    ##  [ reached 'max' / getOption("max.print") -- omitted 5 rows ]

``` r
head(y_data)
```

    ##   V1
    ## 1  5
    ## 2  5
    ## 3  5
    ## 4  5
    ## 5  5
    ## 6  5

``` r
head(s_data)
```

    ##   V1
    ## 1  1
    ## 2  1
    ## 3  1
    ## 4  1
    ## 5  1
    ## 6  1

``` r
# 2. Витягує лише вимірювання середнього значення та стандартного
# відхилення (mean and standard deviation) для кожного вимірювання.

selectedCols <- grep("-(mean|std).*", as.character(feature[,2]))
head(selectedCols)
```

    ## [1] 1 2 3 4 5 6

``` r
# 3. Використовує описові назви діяльностей (activity) для найменування
# діяльностей у наборі даних.

# Отримання назв діяльностей
a_label[,2] <- as.character(a_label[,2])
head(a_label[,2])
```

    ## [1] "WALKING"            "WALKING_UPSTAIRS"   "WALKING_DOWNSTAIRS"
    ## [4] "SITTING"            "STANDING"           "LAYING"

``` r
#4. Відповідно присвоює змінним у наборі даних описові імена

selectedColNames <- feature[selectedCols, 2]
selectedColNames <- gsub("-mean", "Mean", selectedColNames)
selectedColNames <- gsub("-std", "Std", selectedColNames)
selectedColNames <- gsub("[-()]", "", selectedColNames)

x_data <- x_data[selectedCols]
resDataSet <- cbind(s_data, y_data, x_data)
colnames(resDataSet) <- c("Subject", "Activity", selectedColNames)

resDataSet$Activity <- factor(resDataSet$Activity, levels = a_label[,1], labels = a_label[,2])
resDataSet$Subject <- as.factor(resDataSet$Subject)
head(resDataSet)
```

    ##   Subject Activity tBodyAccMeanX tBodyAccMeanY tBodyAccMeanZ tBodyAccStdX
    ## 1       1 STANDING     0.2885845   -0.02029417    -0.1329051   -0.9952786
    ## 2       1 STANDING     0.2784188   -0.01641057    -0.1235202   -0.9982453
    ## 3       1 STANDING     0.2796531   -0.01946716    -0.1134617   -0.9953796
    ## 4       1 STANDING     0.2791739   -0.02620065    -0.1232826   -0.9960915
    ## 5       1 STANDING     0.2766288   -0.01656965    -0.1153619   -0.9981386
    ## 6       1 STANDING     0.2771988   -0.01009785    -0.1051373   -0.9973350
    ##   tBodyAccStdY tBodyAccStdZ tGravityAccMeanX tGravityAccMeanY
    ## 1   -0.9831106   -0.9135264        0.9633961       -0.1408397
    ## 2   -0.9753002   -0.9603220        0.9665611       -0.1415513
    ## 3   -0.9671870   -0.9789440        0.9668781       -0.1420098
    ## 4   -0.9834027   -0.9906751        0.9676152       -0.1439765
    ## 5   -0.9808173   -0.9904816        0.9682244       -0.1487502
    ## 6   -0.9904868   -0.9954200        0.9679482       -0.1482100
    ##   tGravityAccMeanZ tGravityAccStdX tGravityAccStdY tGravityAccStdZ
    ## 1       0.11537494      -0.9852497      -0.9817084      -0.8776250
    ## 2       0.10937881      -0.9974113      -0.9894474      -0.9316387
    ## 3       0.10188392      -0.9995740      -0.9928658      -0.9929172
    ## 4       0.09985014      -0.9966456      -0.9813928      -0.9784764
    ## 5       0.09448590      -0.9984293      -0.9880982      -0.9787449
    ## 6       0.09190972      -0.9989793      -0.9867539      -0.9973064
    ##   tBodyAccJerkMeanX tBodyAccJerkMeanY tBodyAccJerkMeanZ tBodyAccJerkStdX
    ## 1        0.07799634       0.005000803      -0.067830808       -0.9935191
    ## 2        0.07400671       0.005771104       0.029376633       -0.9955481
    ## 3        0.07363596       0.003104037      -0.009045631       -0.9907428
    ## 4        0.07732061       0.020057642      -0.009864772       -0.9926974
    ## 5        0.07344436       0.019121574       0.016779979       -0.9964202
    ## 6        0.07793244       0.018684046       0.009344434       -0.9948136
    ##   tBodyAccJerkStdY tBodyAccJerkStdZ tBodyGyroMeanX tBodyGyroMeanY
    ## 1       -0.9883600       -0.9935750   -0.006100849    -0.03136479
    ## 2       -0.9810636       -0.9918457   -0.016111620    -0.08389378
    ## 3       -0.9809556       -0.9896866   -0.031698294    -0.10233542
    ## 4       -0.9875527       -0.9934976   -0.043409983    -0.09138618
    ## 5       -0.9883587       -0.9924549   -0.033960416    -0.07470803
    ## 6       -0.9887145       -0.9922663   -0.028775508    -0.07039311
    ##   tBodyGyroMeanZ tBodyGyroStdX tBodyGyroStdY tBodyGyroStdZ
    ## 1     0.10772540    -0.9853103    -0.9766234    -0.9922053
    ## 2     0.10058429    -0.9831200    -0.9890458    -0.9891212
    ## 3     0.09612688    -0.9762921    -0.9935518    -0.9863787
    ## 4     0.08553770    -0.9913848    -0.9924073    -0.9875542
    ## 5     0.07739203    -0.9851836    -0.9923781    -0.9874019
    ## 6     0.07901214    -0.9851808    -0.9921175    -0.9830768
    ##   tBodyGyroJerkMeanX tBodyGyroJerkMeanY tBodyGyroJerkMeanZ
    ## 1        -0.09916740        -0.05551737        -0.06198580
    ## 2        -0.11050283        -0.04481873        -0.05924282
    ## 3        -0.10848567        -0.04241031        -0.05582883
    ## 4        -0.09116989        -0.03633262        -0.06046466
    ## 5        -0.09077010        -0.03763253        -0.05828932
    ## 6        -0.09424758        -0.04335526        -0.04193600
    ##   tBodyGyroJerkStdX tBodyGyroJerkStdY tBodyGyroJerkStdZ tBodyAccMagMean
    ## 1        -0.9921107        -0.9925193        -0.9920553      -0.9594339
    ## 2        -0.9898726        -0.9972926        -0.9938510      -0.9792892
    ## 3        -0.9884618        -0.9956321        -0.9915318      -0.9837031
    ## 4        -0.9911194        -0.9966410        -0.9933289      -0.9865418
    ## 5        -0.9913545        -0.9964730        -0.9945110      -0.9928271
    ## 6        -0.9916216        -0.9960147        -0.9930906      -0.9942950
    ##   tBodyAccMagStd tGravityAccMagMean tGravityAccMagStd tBodyAccJerkMagMean
    ## 1     -0.9505515         -0.9594339        -0.9505515          -0.9933059
    ## 2     -0.9760571         -0.9792892        -0.9760571          -0.9912535
    ## 3     -0.9880196         -0.9837031        -0.9880196          -0.9885313
    ## 4     -0.9864213         -0.9865418        -0.9864213          -0.9930780
    ## 5     -0.9912754         -0.9928271        -0.9912754          -0.9934800
    ## 6     -0.9952490         -0.9942950        -0.9952490          -0.9930177
    ##   tBodyAccJerkMagStd tBodyGyroMagMean tBodyGyroMagStd tBodyGyroJerkMagMean
    ## 1         -0.9943364       -0.9689591      -0.9643352           -0.9942478
    ## 2         -0.9916944       -0.9806831      -0.9837542           -0.9951232
    ## 3         -0.9903969       -0.9763171      -0.9860515           -0.9934032
    ## 4         -0.9933808       -0.9820599      -0.9873511           -0.9955022
    ## 5         -0.9958537       -0.9852037      -0.9890626           -0.9958076
    ## 6         -0.9954243       -0.9858944      -0.9864403           -0.9952748
    ##   tBodyGyroJerkMagStd fBodyAccMeanX fBodyAccMeanY fBodyAccMeanZ
    ## 1          -0.9913676    -0.9947832    -0.9829841    -0.9392687
    ## 2          -0.9961016    -0.9974507    -0.9768517    -0.9735227
    ## 3          -0.9950910    -0.9935941    -0.9725115    -0.9833040
    ## 4          -0.9952666    -0.9954906    -0.9835697    -0.9910798
    ## 5          -0.9952580    -0.9972859    -0.9823010    -0.9883694
    ## 6          -0.9952050    -0.9966567    -0.9869395    -0.9927386
    ##   fBodyAccStdX fBodyAccStdY fBodyAccStdZ fBodyAccMeanFreqX
    ## 1   -0.9954217   -0.9831330   -0.9061650        0.25248290
    ## 2   -0.9986803   -0.9749298   -0.9554381        0.27130855
    ## 3   -0.9963128   -0.9655059   -0.9770493        0.12453124
    ## 4   -0.9963121   -0.9832444   -0.9902291        0.02904438
    ## 5   -0.9986065   -0.9801295   -0.9919150        0.18108977
    ## 6   -0.9976438   -0.9922637   -0.9970459        0.15738377
    ##   fBodyAccMeanFreqY fBodyAccMeanFreqZ fBodyAccJerkMeanX fBodyAccJerkMeanY
    ## 1        0.13183575       -0.05205025        -0.9923325        -0.9871699
    ## 2        0.04286364       -0.01430976        -0.9950322        -0.9813115
    ## 3       -0.06461056        0.08267692        -0.9909937        -0.9816423
    ## 4        0.08030227        0.18569468        -0.9944466        -0.9887272
    ## 5        0.05798789        0.55978632        -0.9962920        -0.9887900
    ## 6        0.31883523        0.60559943        -0.9948507        -0.9882443
    ##   fBodyAccJerkMeanZ fBodyAccJerkStdX fBodyAccJerkStdY fBodyAccJerkStdZ
    ## 1        -0.9896961       -0.9958207       -0.9909363       -0.9970517
    ## 2        -0.9897398       -0.9966523       -0.9820839       -0.9926268
    ## 3        -0.9875663       -0.9912488       -0.9814148       -0.9904159
    ## 4        -0.9913542       -0.9913783       -0.9869269       -0.9943908
    ## 5        -0.9906244       -0.9969025       -0.9886067       -0.9929065
    ## 6        -0.9901575       -0.9952180       -0.9901788       -0.9930667
    ##   fBodyAccJerkMeanFreqX fBodyAccJerkMeanFreqY fBodyAccJerkMeanFreqZ
    ## 1            0.87038451            0.21069700            0.26370789
    ## 2            0.60851352           -0.05367561            0.06314827
    ## 3            0.11543400           -0.19343634            0.03825433
    ## 4            0.03579805           -0.09303585            0.16809523
    ## 5            0.27335020            0.07913538            0.29238418
    ## 6            0.32883589            0.05477140            0.32094497
    ##   fBodyGyroMeanX fBodyGyroMeanY fBodyGyroMeanZ fBodyGyroStdX fBodyGyroStdY
    ## 1     -0.9865744     -0.9817615     -0.9895148    -0.9850326    -0.9738861
    ## 2     -0.9773867     -0.9925300     -0.9896058    -0.9849043    -0.9871681
    ## 3     -0.9754332     -0.9937147     -0.9867557    -0.9766422    -0.9933990
    ## 4     -0.9871096     -0.9936015     -0.9871913    -0.9928104    -0.9916460
    ## 5     -0.9824465     -0.9929838     -0.9886664    -0.9859818    -0.9919558
    ## 6     -0.9848902     -0.9927862     -0.9807784    -0.9852871    -0.9916595
    ##   fBodyGyroStdZ fBodyGyroMeanFreqX fBodyGyroMeanFreqY fBodyGyroMeanFreqZ
    ## 1    -0.9940349        -0.25754888         0.09794711         0.54715105
    ## 2    -0.9897847        -0.04816744        -0.40160791        -0.06817833
    ## 3    -0.9873282        -0.21668507        -0.01726417        -0.11072029
    ## 4    -0.9886776         0.21686246        -0.13524536        -0.04972798
    ## 5    -0.9879443        -0.15334258        -0.08840273        -0.16223039
    ## 6    -0.9853661        -0.36303968        -0.13323831         0.19483324
    ##   fBodyAccMagMean fBodyAccMagStd fBodyAccMagMeanFreq
    ## 1      -0.9521547     -0.9561340         -0.08843612
    ## 2      -0.9808566     -0.9758658         -0.04414989
    ## 3      -0.9877948     -0.9890155          0.25789914
    ## 4      -0.9875187     -0.9867420          0.07358150
    ## 5      -0.9935909     -0.9900635          0.39431033
    ## 6      -0.9948360     -0.9952833          0.43796212
    ##   fBodyBodyAccJerkMagMean fBodyBodyAccJerkMagStd
    ## 1              -0.9937257             -0.9937550
    ## 2              -0.9903355             -0.9919603
    ## 3              -0.9892801             -0.9908667
    ## 4              -0.9927689             -0.9916998
    ## 5              -0.9955228             -0.9943890
    ## 6              -0.9947329             -0.9951562
    ##   fBodyBodyAccJerkMagMeanFreq fBodyBodyGyroMagMean fBodyBodyGyroMagStd
    ## 1                   0.3469885           -0.9801349          -0.9613094
    ## 2                   0.5320605           -0.9882956          -0.9833219
    ## 3                   0.6607950           -0.9892548          -0.9860277
    ## 4                   0.6789213           -0.9894128          -0.9878358
    ## 5                   0.5590577           -0.9914330          -0.9890594
    ## 6                   0.2469096           -0.9905000          -0.9858609
    ##   fBodyBodyGyroMagMeanFreq fBodyBodyGyroJerkMagMean
    ## 1               -0.1289889               -0.9919904
    ## 2               -0.2719585               -0.9958539
    ## 3               -0.2127279               -0.9950305
    ## 4               -0.0356842               -0.9952207
    ## 5               -0.2735820               -0.9950928
    ## 6               -0.2973291               -0.9951433
    ##   fBodyBodyGyroJerkMagStd fBodyBodyGyroJerkMagMeanFreq
    ## 1              -0.9906975                  -0.07432303
    ## 2              -0.9963995                   0.15807454
    ## 3              -0.9951274                   0.41450281
    ## 4              -0.9952369                   0.40457253
    ## 5              -0.9954648                   0.08775301
    ## 6              -0.9952387                   0.01995331

``` r
#5. З набору даних з кроку 4 створити другий незалежний акуратний набір
# даних (tidy dataset) із середнім значенням для кожної змінної для кожної
# діяльності та кожного суб’єкту (subject).
meltedData <- melt(resDataSet, id = c("Subject", "Activity"))
tidyData <- dcast(meltedData, Subject + Activity ~ variable, mean)

write.table(tidyData, "./tidy_dataset.txt", row.names = FALSE, quote = FALSE)
```
